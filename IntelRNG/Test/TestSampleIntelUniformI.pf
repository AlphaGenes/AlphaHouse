@test
subroutine TestSampleIntelUniformI()

  use pFUnit_mod
  use IntelRNGMod

  implicit none

  integer(kind=4) :: n
  integer(kind=4),allocatable,dimension(:) :: x

  call IntitialiseIntelRNG

  n=100
  allocate(x(n))

  x(1:2)=0
  @assertEqual(SampleIntelUniformI(    a=0,b=0),x(1:1),"Samples from Uniform(0,0) should be 0.")
  @assertEqual(SampleIntelUniformI(n=2,a=0,b=0),x(1:2),"Samples from Uniform(0,0) should be 0.")

  x=SampleIntelUniformI(n=n,a=5,b=10)
  @assertEqual(count(x <  5),0,"Samples from Uniform(5,10) should be all >=  5.")
  @assertEqual(count(x > 10),0,"Samples from Uniform(5,10) should be all <= 10.")

  call UnintitialiseIntelRNG

end subroutine TestSampleIntelUniformI
